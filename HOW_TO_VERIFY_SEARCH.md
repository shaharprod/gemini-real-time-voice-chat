# 🔍 איך לבדוק שהחיפוש בזמן אמת עובד

## שלב 1: פתח את הקונסול (Console)

1. לחץ `F12` או `Ctrl+Shift+I` (Windows/Linux) או `Cmd+Option+I` (Mac)
2. לך לטאב **Console** (קונסול)
3. ודא שהקונסול נקי (לחץ על האייקון של "Clear console" אם צריך)

## שלב 2: הפעל את התוכנה

1. התחל שיחה עם AI (לחץ על כפתור "שיחה עם AI")
2. שאל שאלה שתפעיל חיפוש, למשל:
   - "מה חדשות היום?"
   - "כותרות חדשות"
   - "מה קורה בישראל?"
   - "חדשות עולם"

## שלב 3: בדוק את הלוגים בקונסול

כשהחיפוש מתבצע, אתה אמור לראות:

### ✅ אם החיפוש עובד:

```
🔍🔍🔍 ========================================
🔍 [בדיקת חיפוש בזמן אמת]
🔍 isSearchEnabled: true
🔍 isCustomSearchEnabled: true
🔍 shouldAlwaysSearch: true
🔍 API Key: PRESENT (AIzaSy...)
🔍 CX: PRESENT (83f6b2cb...)
🔍 טקסט המשתמש: ...
🔍 ========================================

✅✅✅ ========================================
✅ [חיפוש בזמן אמת] מתחיל חיפוש חדש!
✅ API Key: PRESENT
✅ CX: PRESENT
✅ שולח בקשה ל-Google Custom Search API...
✅ ========================================

🌐🌐🌐 ========================================
🌐 [מנגנון חיפוש באינטרנט] מתחיל
🌐 שאילתת חיפוש: ...
🌐 ========================================

✅✅✅ [מנגנון חיפוש] הגדרות תקינות
✅ API Key: PRESENT
✅ CX: PRESENT
✅ חיבור למודל: פעיל ✅

🔍 [חיפוש באינטרנט] מתחיל חיפוש...
🔍 Query: ...
🔍 URL: ...

⏱️ [חיפוש באינטרנט] תגובה התקבלה: XXXms, status: 200

✅ [חיפוש באינטרנט] נמצאו X תוצאות מהחיפוש
✅ [חיפוש באינטרנט] X תוצאות תקפות אחרי סינון

📋 [חיפוש באינטרנט] תוצאות ראשונות:
  1. [כותרת 1]
     [URL 1]
  2. [כותרת 2]
     [URL 2]

📤 [חיפוש באינטרנט] שולח תוצאות למודל...
✅✅✅ [חיפוש באינטרנט] תוצאות נשלחו למודל בהצלחה!

📊📊📊 ========================================
📊 [תוצאות חיפוש]
📊 success: true
📊 results.length: X
📊 sentToModel: true
📊 תוצאות ראשונות:
📊   1. [כותרת 1]
📊      [URL 1]
📊 ========================================

✅✅✅ [מנגנון חיפוש] הושלם בהצלחה!
✅ המודל קיבל את התוצאות ויכול להשתמש בהן
```

### ❌ אם החיפוש לא עובד:

#### בעיה 1: API Key או CX חסרים

```
⚠️⚠️⚠️ ========================================
⚠️ [Custom Search API לא מוגדר]
⚠️ API Key: MISSING ❌
⚠️ CX: MISSING ❌
⚠️ כדי להפעיל חיפוש, ודא שהגדרת את GOOGLE_CUSTOM_SEARCH_API_KEY ו-GOOGLE_CUSTOM_SEARCH_CX ב-.env.local
⚠️ ========================================
```

**פתרון:**
1. ודא שיש לך קובץ `.env.local` בשורש הפרויקט
2. ודא שהקובץ מכיל:
   ```
   GOOGLE_CUSTOM_SEARCH_API_KEY=your_api_key_here
   GOOGLE_CUSTOM_SEARCH_CX=your_cx_here
   ```
3. הפעל מחדש את השרת (`npm run dev`)

#### בעיה 2: שגיאת API (401, 403, 400)

```
❌ [חיפוש באינטרנט] שגיאה: 401 Unauthorized
API Error: Invalid API key
```

**פתרון:**
- ודא שה-API Key תקין
- ודא שהפעלת את Custom Search API ב-Google Cloud Console
- ודא שה-API Key מוגבל רק ל-Custom Search API

#### בעיה 3: לא נמצאו תוצאות

```
⚠️ [חיפוש באינטרנט] לא נמצאו תוצאות עם d1, מנסה עם d7...
⚠️ [חיפוש באינטרנט] לא נמצאו תוצאות גם אחרי נסיון עם d7
```

**פתרון:**
- זה יכול להיות תקין - אולי באמת אין חדשות על הנושא הזה היום
- נסה שאלה כללית יותר, למשל: "חדשות היום" במקום נושא ספציפי

## שלב 4: בדוק שהחיפוש מופעל

1. בדוק את הכפתורים בחלק העליון של האפליקציה
2. ודא שהכפתורים "חיפוש פעיל" ו-"Custom Search" מופעלים (הם צריכים להיות כחולים/סגולים)
3. אם הם אפורים, לחץ עליהם כדי להפעיל

## שלב 5: בדוק שהתוצאות מגיעות למודל

אחרי שהחיפוש מתבצע, המודל צריך לקבל את התוצאות. אם אתה רואה בקונסול:

```
✅✅✅ [חיפוש באינטרנט] תוצאות נשלחו למודל בהצלחה!
✅ המודל קיבל את התוצאות ויכול להשתמש בהן
```

אז החיפוש עובד! המודל יוכל להשתמש בתוצאות כדי לענות על השאלות שלך.

## טיפים נוספים:

1. **החיפוש מתבצע במקביל** - הוא לא חוסם את השיחה, אז אתה יכול להמשיך לדבר
2. **החיפוש מתבצע אוטומטית** - כשאתה שואל על חדשות, החיפוש מתחיל אוטומטית
3. **התוצאות נשלחות למודל** - המודל מקבל את התוצאות וניתן להשתמש בהן לתשובות

## אם עדיין לא עובד:

1. **בדוק את הקונסול** - כל המידע נמצא שם
2. **ודא שהגדרות נכונות** - `.env.local` עם API Key ו-CX
3. **הפעל מחדש את השרת** - לפעמים צריך להפעיל מחדש אחרי שינויים ב-`.env.local`
4. **בדוק את הרשת** - ודא שיש חיבור לאינטרנט

